<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>cross section</title>
  <link rel="stylesheet" href="./assets/materialize.min.css" />
  <script src="./assets/materialize.min.js"></script>
  <script>
    let data;
    let myChart;
    let dlmin = -0.2; // %nm
    let dlmax = 0.2;
    let step = 0.0003;
    let experimentData = [], fittingData = [];
  </script>
</head>

<body class="grey lighten-3">
  <nav class="deep-purple darken-2">
    <div class="nav-wrapper">
      <span class="brand-logo center">cross section splitting file</span>
      <ul id="nav-mobile" class="right hide-on-small-and-down">
        <li><a href="index.html"><b>fitting</b></a></li>
        <li><a href="https://github.com/takapiro99/plasma-laser-fitting/">about</a></li>
      </ul>
    </div>
  </nav>
  <div class="container">
    <div>
      <p>
      <h5 style="display: inline-block;margin-right:1em">1. select .txt file</h5>
      <input type="file" onchange="inputFileAndDraw(this)" accept=".txt" id="fileInput" />
      </p>
      <div style="cursor: default; user-select: none;">
        <p id="dropZone" style="text-align: center;height:50px;width:70%;background: lightyellow;line-height: 50px;margin:0 auto;border-radius:7px;transition: all .16s ease;">or drop here</p>
      </div>
      <p id="input-file-status"></p>
    </div>
    <div id="console" style="pointer-events:none;color:lightgrey !important;">
      <!-- <div id="console" style="color:lightgrey !important;"> -->

      <p>
      <h5><s> 2. preview</s></h5>
      準備中
      </p>
      <form onsubmit="event.preventDefault();downloadZip();">
        <div>
          <h5>3. parameters</h5>
          <div class="row">
            <p class="col s4">
              <label for="min">from<input type="number" name="min" value="1" id='min' min="1" max="1024"></label>
            </p>
            <p class="col s4">
              <label for="max">to<input type="number" name="max" id="max" value="1024" min="1" max="1024"></label>
            </p>
            <p class="col s4">
              <label for="step">step<input type="number" name="step" id="step" value="2" min="1" max="1024"></label>
            </p>
          </div>
          <p class="grey-text">output will be calculated as average</p>
          <!-- <div class="row">
        <p class="col s6">
          <label>
            <input name="mode" type="radio" checked />
            <span>average</span>
          </label>
          <label>
            <input name="mode" type="radio" />
            <span>sum</span>
          </label>
        </p>
      </div> -->
        </div>
        <div>
          <h5>4. Download as zip</h5>
          <p>
            <button type="submit" id="downloadButton"
              class="waves-effect waves-light btn-small indigo disabled">download</button>
          </p>
        </div>
      </form>
    </div>
  </div>

  <div style="height:300px"></div>

  <script src="./cross-section.js"></script>
  <script>
    const dropZone = document.getElementById("dropZone")
    const fileInput = document.getElementById("fileInput")


  dropZone.addEventListener('dragover', function(e) {
    e.stopPropagation();
    e.preventDefault();
    this.style.background = '#a1a7f0';
  }, false);

    dropZone.addEventListener('dragleave', function(e) {
        e.stopPropagation();
        e.preventDefault();
        this.style.background = 'lightyellow';
    }, false);

  dropZone.addEventListener('drop', function(e) {
        e.stopPropagation();
        e.preventDefault();
        this.style.background = 'lightyellow'; //背景色を白に戻す
        var files = e.dataTransfer.files; //ドロップしたファイルを取得
        if (files.length !== 1) {return alert('アップロードできるファイルは1つだけです。');}
        fileInput.files = files; //inputのvalueをドラッグしたファイルに置き換える。
        inputFileAndDraw(fileInput)
    }, false);
  </script>
</body>

</html>